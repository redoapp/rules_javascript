load("@bazel_util//file:rules.bzl", "directory")
load("@rules_javascript//commonjs:rules.bzl", "cjs_root")
load("@rules_javascript//nodejs:rules.bzl", "nodejs_binary")
load("@rules_javascript//typescript:rules.bzl", "ts_library")

cjs_root(
    name = "root",
    package_name = "@rules-javascript-test/typescript-directory",
)

directory(
    name = "src",
    srcs = [
        "src/lib.ts",
        "src/main.ts",
    ],
    strip_prefix = "src",
)

ts_library(
    name = "lib",
    srcs = [":src"],
    compiler = "//:ts",
    declaration_prefix = "types",
    js_prefix = "lib",
    root = ":root",
    strip_prefix = "src",
)

nodejs_binary(
    name = "bin",
    dep = ":lib",
    main = "lib/main.js",
)
